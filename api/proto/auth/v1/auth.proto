syntax = "proto3";

package auth.v1;

option go_package = "github.com/mohamedfawas/qubool-kallyanam/api/proto/auth/v1;authv1";

import "google/protobuf/timestamp.proto";

service AuthService {
  // Health check endpoint
  rpc HealthCheck(HealthCheckRequest) returns (HealthCheckResponse);
  
  // Register a new user
  rpc RegisterUser(RegisterUserRequest) returns (RegisterUserResponse);
  
  // Login with email/phone and password
  rpc Login(LoginRequest) returns (LoginResponse);
  
  // Verify OTP during registration
  rpc VerifyRegistration(VerifyRegistrationRequest) returns (VerifyRegistrationResponse);
}

// Health check messages
message HealthCheckRequest {}

message HealthCheckResponse {
  string status = 1;  // "UP", "DOWN", etc.
}

// Registration messages
message RegisterUserRequest {
  string email = 1;
  string phone = 2;
  string password = 3;
}

message RegisterUserResponse {
  bool success = 1;
  string message = 2;
  string error = 3;
  google.protobuf.Timestamp otp_expires_at = 4;
  google.protobuf.Timestamp resend_allowed_at = 5;
}

// Login messages
message LoginRequest {
  string identifier = 1;  // Email or phone
  string password = 2;
}

message LoginResponse {
  bool success = 1;
  string message = 2;
  string error = 3;
  string access_token = 4;
  string refresh_token = 5;
  google.protobuf.Timestamp token_expires_at = 6;
}

// Verification messages
message VerifyRegistrationRequest {
  string email = 1;
  string otp = 2;
}

message VerifyRegistrationResponse {
  bool success = 1;
  string message = 2;
  string error = 3;
  string access_token = 4;  // JWT token if verified successfully
  string refresh_token = 5;
}